{% extends 'base.html' %}

{% block page_title %}Match{% endblock %}

{% block content %}
<div class="page-container matches-page">
    <section class="header">
         <h2>Match Details</h2> 
         <a class="group-rtn-btn link-btn click-shrink" href="{% url 'group-home' groupid %}">Back</a>
    </section>
    
    
    <section class="match-data">
        {% if match_data %}
        <div class="container overview-container">
            <div class="row">
                <p>Match ID:<span>{{ match_data.pk }}</span></p> 
                <p>Date:<span>{{ match_data.date_of_match|date:'d-m-Y' }}</span></p> 
                <p>Time:<span>{{ match_data.time_of_match|time:"H:i" }}</span></p> 
            </div>
            <div class="row">
            {% if 'S' in match_data.match_status %}
                <p>Status:<span class="scheduled">ON</span></p>
            {% else %}
                <p>Status:<span class="cancelled">CANCELLED</span></p>
            {% endif %}
            </div>
            <div class="row">
                <p>Venue:<span>{{ match_data.venue }}</span></p> 
            </div>
            <div class="row">
                <p>Notes:<span>{{ match_data.match_notes }}</span></p>
            </div>
            <div class="link-btn edit-match-btn click-shrink">Edit Match</div> 
        </div>
        {% endif %}
        
        {% if match_data %}
             <form class="start-hidden match-form" method="POST" action="{% url 'add-edit-match' groupid matchid %}">
                 <div class="close-parent-btn">x</div>
        {% else %}
            <form class="match-form" method="POST" action="{% url 'add-edit-match' groupid matchid %}">
        {% endif %}
            {% csrf_token %}
            <div class="row">
            <label for="date_of_match">Date: </label>
            <input required type="date" name="date_of_match" 
            {% if match.pk != 0 %}
            value={{ match_data.date_of_match|date:'Y-m-d' }}
            {% endif %}/>
            </div>
            <div class="row">
            <label for="time_of_match">Time: </label>
            <input required type="time" name="time_of_match"
            {% if match.pk != 0 %}
            value={{ match_data.time_of_match|time:"H:i" }}
            {% endif %}/>
            </div>
            {{ match_form.as_p }}
            {{ form.non_field_errors }}
            {% if not match_data %}
                <label for="repeat">Please repeat for:</label>
                <input type="number" name="repeat" value="1" min="1" max="10" step="1"/> weeks
            {% endif %}
            <button class="create-edit-match-btn click-shrink" type="submit">Submit</button>
        </form>
         
    </section>
    {% if group_data %}
    <section class="player-availability">
        <h3>Player availability</h3> 
        <div class="container member-container">
            {% for user in group_data.users.all %}
                <div class="row">
                    <div class="user-container">
                        <a class="shirt click-shrink" href="{% url 'player-profile' user.pk group_data.pk %}">
                            <span class="container">
                                <p id="curve-{{ user.pk }}" class="member-content username">
                                    {% if user.nickname %}
                                        {{ user.nickname }}
                                    {% else %}?????{% endif %}
                                </p>
                            </span>
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}
</div>


{% endblock %}